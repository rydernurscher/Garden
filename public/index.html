<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard - MyGarden Planner</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body class="app-body">
  <header class="header">MyGarden Planner</header>
  <aside class="sidebar">
    <a href="index.html" class="nav-item active">Dashboard</a>
    <a href="plant-library.html" class="nav-item">Plant Library</a>
    <a href="planner.html" class="nav-item">Planner</a>
    <button id="btn-logout" class="btn small">Logout</button>
  </aside>
  <main class="main-content">
    <section id="dashboard" class="section active">
      <h1>Welcome to your Dashboard!</h1>
      <div class="dashboard-cards">
        <div class="card">
          <h3>Upcoming Tasks</h3>
          <ul>
            <li>Water Rose (tomorrow)</li>
            <li>Prune Basil (in 3 days)</li>
            <li>Harvest Lavender (in 5 days)</li>
          </ul>
        </div>
        <div class="card">
          <h3>Weather</h3>
          <p>22°C, Sunny</p>
        </div>
        <div class="card">
          <h3>My Library Size</h3>
          <p><strong id="stat-plants">0</strong> plants saved</p>
        </div>
      </div>
    </section>
  </main>
  <footer class="footer">© 2025 MyGarden Planner</footer>

  <script>
    (async () => {
      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = 'login.html';
        return;
      }
      try {
        const res = await fetch('/api/user-plants', {
          headers: { 'Authorization': 'Bearer ' + token }
        });
        if (res.ok) {
          const saved = await res.json();
          document.getElementById('stat-plants').textContent = Array.isArray(saved)
            ? saved.length
            : 0;
        }
      } catch {
        // Ignore errors here; dashboard can still load
      }
    })();
  </script>

  <script
    src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"
  ></script>
  <script>
    const SUPABASE_URL      = 'https://niibkcnqsyvbqgyylssx.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5paWJrY25xc3l2YnFneXlsc3N4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg4NjEyMTEsImV4cCI6MjA2NDQzNzIxMX0.ORk7xULOuYVq0n_9aSQYZPg1icJlHML7m_nlsyPQOn0';
    window.supabaseClient  = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>
  <script src="assets/common.js" defer></script>
</body>
</html>
